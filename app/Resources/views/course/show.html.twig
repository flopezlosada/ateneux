{% extends '::layout_show.html.twig' %}
{% block more_css %}
    <link rel="stylesheet" href="{{ asset('bundles/app/fancybox/jquery.fancybox.css') }}"/>
{% endblock %}
{% block main -%}
    <div class="panel panel-default">
        <div class="panel-heading">
            <h1>Ficha de curso: {{ course }} </h1>
            {% if course.getMentorTeacher == null %}
                <div class="alert alert-danger">
                    Debes definir la/el tutor del curso <a
                            href="{{ path('teacher_select_mentor_teacher', {'course_id': course.id}) }}"
                            class="alert-link">Indicar</a>.
                </div>
            {% endif %}
        </div>
        <div class="panel-body">
            <div class="row">
                <div class="col-lg-12">
                    <p><strong>Nombre: </strong>{{ course }}</p>

                    <strong>Fecha de inicio:</strong> {{ course.startdate|localizeddate('long','none','es') }}<br>

                    <strong>Fecha de fin:</strong> {{ course.enddate|localizeddate('long','none','es') }}

                    {% if course.getMentorTeacher is not null %}
                        <p><strong>Tutora/or del curso: <a
                                        href="{{ path('teacher_show', {'id': course.getMentorTeacher.id}) }}">{{ course.getMentorTeacher }}</a>
                            </strong></p>
                    {% endif %}


                    {% if course.getStudents|length>0 %}
                        <div class="alert alert-info"> <h4>Listado de estudiantes</h4></div>
                        <div class="table-responsive">
                            <table id="table_list"
                                   class="table table-striped table-bordered table-hover dataTable no-footer"
                                   aria-describedby="dataTables-example_info">
                                <thead>
                                <tr>
                                    <th>Nombre completo</th>
                                    <th>Acciones</th>
                                </tr>
                                </thead>
                                <tfoot>
                                <tr role="row">
                                </tr>
                                </tfoot>
                                <tbody>
                                {% for student in course.getStudents %}
                                    <tr>
                                        <td><a href="{{ path('student_show', { 'id': student.id }) }}">{{ student }}</a>
                                        </td>
                                        <td>
                                            <ul>
                                                {% if is_granted("ROLE_ADMIN") %}
                                                    <li>
                                                        <a href="{{ path('student_edit', { 'id': student.id }) }}">editar</a>
                                                    </li>
                                                    {% if student.getCourse.getId is not defined %}
                                                        <li>
                                                            <a href="{{ path('student_course', {'student_id': student.id}) }}"
                                                               class="alert-link">Definir curso</a>.
                                                        </li>
                                                    {% endif %}
                                                {% endif %}
                                                {% if (is_granted("ROLE_TEACHER") and app.user.getTeacher.getMentorCourse.id == course.id) or is_granted ("ROLE_ADMIN") %}
                                                    <li>
                                                        <a href="{{ path('meeting_new', {'student_id': student.id}) }}">Programar
                                                            reunión
                                                        </a></li>

                                                {% endif %}
                                            </ul>
                                        </td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    {% endif %}
                    {% if course.assessmentsBoard|length >0 %}
                        <div class="alert alert-info"><h4>Juntas de evaluación</h4></div>
                        <div class="table-responsive">
                            <table id="table_list"
                                   class="table table-striped table-bordered table-hover dataTable no-footer"
                                   aria-describedby="dataTables-example_info">
                                <thead>
                                <tr>
                                    <th>Nombre completo</th>
                                    <th>Acciones</th>
                                </tr>
                                </thead>
                                <tfoot>
                                <tr role="row">
                                </tr>
                                </tfoot>
                                <tbody>
                                {% for assessment in course.assessmentsBoard %}
                                    <tr>
                                        <td>
                                            <a href="{{ path('assessmentboard_show', {'id': assessment.getId}) }}">{{ assessment }}</a>
                                        </td>
                                        <td>
                                            <ul>
                                                {% if (is_granted("ROLE_TEACHER") and app.user.getTeacher.getMentorCourse.id == course.id) or is_granted ("ROLE_ADMIN") %}
                                                    <li>
                                                        <a href="{{ path('assessmentboard_edit', {'id': assessment.getId }) }}">Editar</a>
                                                    </li>
                                                {% endif %}
                                            </ul>
                                        </td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    {% if is_granted("ROLE_ADMIN") %}
        <ul>
            <li>
                <a href="{{ path('course_index') }}">Back to the list</a>
            </li>
            <li>
                <a href="{{ path('course_edit', { 'id': course.id }) }}">Edit</a>
            </li>
            <li>
                {{ form_start(delete_form) }}
                <input type="submit" value="{{"Delete"|trans}}">
                {{ form_end(delete_form) }}
            </li>
        </ul>
    {% endif %}
{% endblock %}